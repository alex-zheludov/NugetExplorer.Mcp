using NuGetExplorerMcp.Domain.Entities;
using NuGetExplorerMcp.Domain.ValueObjects;

namespace NuGetExplorerMcp.Application.Interfaces;

/// <summary>
/// Scans packages for known security vulnerabilities.
/// </summary>
public interface IVulnerabilityScanner
{
    /// <summary>
    /// Gets all known vulnerabilities for a specific package version.
    /// </summary>
    /// <param name="package">The package to scan.</param>
    /// <param name="cancellationToken">Cancellation token.</param>
    /// <returns>List of vulnerabilities affecting the package.</returns>
    Task<IReadOnlyList<Vulnerability>> GetVulnerabilitiesAsync(
        PackageReference package,
        CancellationToken cancellationToken = default);
}
